import{j as e,aZ as a,V as s,L as t,b4 as r,a0 as l,X as d,O as n}from"./ui-v2ReSvUE.js";import{r as c}from"./react-YWE4JMTy.js";import{u as i,s as o}from"./index-Cgc97SP_.js";import{f as m}from"./format-DltpeZFQ.js";import"./router-BNBI7_bc.js";import"./supabase-Du4GZSDg.js";function x(){const{user:x}=i(),[h,g]=c.useState([]),[u,j]=c.useState(!1),[b,p]=c.useState(null),[k,w]=c.useState(!1),[f,N]=c.useState({track_name:"",title:"",content:"",weather:"",track_surface:"",what_worked:"",what_didnt_work:"",changes_made:"",results:"",tags:""});c.useEffect(()=>{x&&v()},[x]);const v=async()=>{if(!x)return;w(!0);const{data:e,error:a}=await o.from("track_notebooks").select("*").eq("user_id",x.id).order("date",{ascending:!1});!a&&e&&g(e),w(!1)},y=()=>{j(!1),p(null),N({track_name:"",title:"",content:"",weather:"",track_surface:"",what_worked:"",what_didnt_work:"",changes_made:"",results:"",tags:""})};return x?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:()=>j(!0),className:"w-full px-4 py-3 bg-brand-gold text-white rounded-lg hover:bg-brand-gold-dark inline-flex items-center justify-center gap-2",children:[e.jsx(s,{className:"w-5 h-5"}),"New Track Note"]}),!k||h&&0!==h.length?h&&0!==h.length?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:h.map(a=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold mb-1",children:a.title}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[a.track_name," • ",m(new Date(a.date),"MMM d, yyyy")]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>(e=>{p(e),N({track_name:e.track_name,title:e.title,content:e.content||"",weather:e.weather||"",track_surface:e.track_surface||"",what_worked:e.what_worked||"",what_didnt_work:e.what_didnt_work||"",changes_made:e.changes_made||"",results:e.results||"",tags:e.tags.join(", ")}),j(!0)})(a),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full",children:e.jsx(r,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>(async e=>{if(!confirm("Delete this note?"))return;w(!0);const{error:a}=await o.from("track_notebooks").delete().eq("id",e);a||await v(),w(!1)})(a.id),className:"p-2 hover:bg-red-100 dark:hover:bg-red-900/20 rounded-full text-red-600",children:e.jsx(l,{className:"w-4 h-4"})})]})]}),a.content&&e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-3",children:a.content}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[a.weather&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Weather:"})," ",e.jsx("span",{className:"font-medium",children:a.weather})]}),a.track_surface&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Surface:"})," ",e.jsx("span",{className:"font-medium",children:a.track_surface})]}),a.results&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Results:"})," ",e.jsx("span",{className:"font-medium",children:a.results})]})]}),a.what_worked&&e.jsxs("div",{className:"mt-3 p-3 bg-green-50 dark:bg-green-900/20 rounded",children:[e.jsx("div",{className:"text-xs font-semibold text-green-700 dark:text-green-400 mb-1",children:"What Worked"}),e.jsx("div",{className:"text-sm",children:a.what_worked})]}),a.what_didnt_work&&e.jsxs("div",{className:"mt-3 p-3 bg-red-50 dark:bg-red-900/20 rounded",children:[e.jsx("div",{className:"text-xs font-semibold text-red-700 dark:text-red-400 mb-1",children:"What Didn't Work"}),e.jsx("div",{className:"text-sm",children:a.what_didnt_work})]}),a.tags&&a.tags.length>0&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:a.tags.map((a,s)=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded text-xs",children:a},s))})]},a.id))}):e.jsxs("div",{className:"text-center py-12 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx(a,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No track notes yet. Start documenting your racing insights!"})]}):e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(t,{className:"w-8 h-8 animate-spin text-brand-gold"})}),u&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm overflow-y-auto",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-2xl my-8",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold",children:[b?"Edit":"New"," Track Note"]}),e.jsx("button",{onClick:y,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full",children:e.jsx(d,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto pr-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Track Name *"}),e.jsx("input",{type:"text",value:f.track_name,onChange:e=>N({...f,track_name:e.target.value}),className:"w-full p-3 rounded-lg",placeholder:"e.g., Eldora Speedway",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title *"}),e.jsx("input",{type:"text",value:f.title,onChange:e=>N({...f,title:e.target.value}),className:"w-full p-3 rounded-lg",placeholder:"e.g., Kings Royal Practice",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"General Notes"}),e.jsx("textarea",{value:f.content,onChange:e=>N({...f,content:e.target.value}),className:"w-full p-3 rounded-lg",rows:4,placeholder:"Overall observations and notes..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Weather"}),e.jsx("input",{type:"text",value:f.weather,onChange:e=>N({...f,weather:e.target.value}),className:"w-full p-3 rounded-lg",placeholder:"e.g., Sunny, 85°F"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Track Surface"}),e.jsx("input",{type:"text",value:f.track_surface,onChange:e=>N({...f,track_surface:e.target.value}),className:"w-full p-3 rounded-lg",placeholder:"e.g., Heavy, slick, tacky"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-green-600 dark:text-green-400",children:"What Worked"}),e.jsx("textarea",{value:f.what_worked,onChange:e=>N({...f,what_worked:e.target.value}),className:"w-full p-3 rounded-lg",rows:3,placeholder:"Setup changes or approaches that were successful..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-red-600 dark:text-red-400",children:"What Didn't Work"}),e.jsx("textarea",{value:f.what_didnt_work,onChange:e=>N({...f,what_didnt_work:e.target.value}),className:"w-full p-3 rounded-lg",rows:3,placeholder:"Things to avoid or problems encountered..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Changes Made"}),e.jsx("textarea",{value:f.changes_made,onChange:e=>N({...f,changes_made:e.target.value}),className:"w-full p-3 rounded-lg",rows:2,placeholder:"Setup adjustments throughout the event..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Results"}),e.jsx("input",{type:"text",value:f.results,onChange:e=>N({...f,results:e.target.value}),className:"w-full p-3 rounded-lg",placeholder:"e.g., Heat: 3rd, Feature: 5th"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tags"}),e.jsx("input",{type:"text",value:f.tags,onChange:e=>N({...f,tags:e.target.value}),className:"w-full p-3 rounded-lg",placeholder:"Separate tags with commas (e.g., slick, hot, heavy)"})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[e.jsx("button",{onClick:y,className:"px-6 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600",children:"Cancel"}),e.jsxs("button",{onClick:async()=>{if(!x||!f.track_name.trim()||!f.title.trim())return;w(!0);const e={user_id:x.id,...f,tags:f.tags.split(",").map(e=>e.trim()).filter(e=>e)};if(b){const{error:a}=await o.from("track_notebooks").update(e).eq("id",b.id);a||(await v(),y())}else{const{error:a}=await o.from("track_notebooks").insert(e);a||(await v(),y())}w(!1)},disabled:k||!f.track_name.trim()||!f.title.trim(),className:"px-6 py-2 bg-brand-gold text-white rounded-lg hover:bg-brand-gold-dark disabled:opacity-50 flex items-center gap-2",children:[k?e.jsx(t,{className:"w-4 h-4 animate-spin"}):e.jsx(n,{className:"w-4 h-4"}),"Save Note"]})]})]})]})})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(a,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Sign in to access track notebook"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Keep detailed notes on track conditions, setups, and race results"})]})}export{x as default};
