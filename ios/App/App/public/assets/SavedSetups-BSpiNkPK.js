const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-D5MCeBH0.js","assets/index-Cgc97SP_.js","assets/ui-v2ReSvUE.js","assets/react-YWE4JMTy.js","assets/router-BNBI7_bc.js","assets/supabase-Du4GZSDg.js","assets/index-DJac0eIf.css","assets/index-CsRCr0z8.js","assets/web-BqzDtJZI.js"])))=>i.map(i=>d[i]);
import{j as e,ac as a,ae as t,a5 as s,X as r,ag as l,a as n,_ as i,D as d,aN as o,aO as c,B as m,ai as x,L as g,aP as p,aQ as h,M as u,p as b,ak as j,aq as y,a8 as f,a0 as v}from"./ui-v2ReSvUE.js";import{r as N}from"./react-YWE4JMTy.js";import{r as w,_,u as k,s as S,C}from"./index-Cgc97SP_.js";import{u as $,R as T}from"./index-CsRCr0z8.js";import{d as D,u as E}from"./router-BNBI7_bc.js";var L,F,U,A;(F=L||(L={})).Documents="DOCUMENTS",F.Data="DATA",F.Library="LIBRARY",F.Cache="CACHE",F.External="EXTERNAL",F.ExternalStorage="EXTERNAL_STORAGE",(A=U||(U={})).UTF8="utf8",A.ASCII="ascii",A.UTF16="utf16";const P=w("Filesystem",{web:()=>_(()=>import("./web-D5MCeBH0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])).then(e=>new e.FilesystemWeb)}),R=w("Share",{web:()=>_(()=>import("./web-BqzDtJZI.js"),__vite__mapDeps([8,1,2,3,4,5,6])).then(e=>new e.ShareWeb)});function O({setup:a,carType:t}){var s;const r=(t,s)=>{const r=Object.keys(a.setup_data).filter(e=>e.startsWith(t.toLowerCase()+"_"));return 0===r.length?null:e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xl font-bold border-b-2 border-gray-300 pb-1 mb-3",children:t}),e.jsx("div",{className:"grid grid-cols-2 gap-x-8 gap-y-2",children:r.map(s=>{var r;const l=s.replace(`${t.toLowerCase()}_`,""),n=(null==(r=a.setup_data[s])?void 0:r.feature)||"N/A";return e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-medium capitalize",children:[l,":"]}),e.jsx("span",{children:n})]},s)})})]})};return e.jsxs("div",{className:"p-8 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold mb-2",children:[t.toUpperCase()," Setup"]}),e.jsxs("p",{className:"text-xl",children:[a.car_number?`Car #${a.car_number}`:"Untitled Setup",a.track_name&&` - ${a.track_name}`]}),e.jsx("p",{className:"text-gray-600",children:(l=(null==(s=a.track_conditions)?void 0:s.date)||a.created_at,l?new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[e.jsxs("div",{children:[r("Left Front",a.setup_data),r("Right Front",a.setup_data),r("Engine",a.setup_data)]}),e.jsxs("div",{children:[r("Left Rear",a.setup_data),r("Right Rear",a.setup_data),r("Wing",a.setup_data),r("Rear",a.setup_data)]})]}),e.jsxs("div",{className:"mt-8 text-center text-sm text-gray-500",children:[e.jsx("p",{children:"Printed from PitBox - Your Digital Crew Chief"}),e.jsx("p",{children:(new Date).toLocaleDateString()})]})]});var l}const I=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{carType:w}=D(),_=E(),[F,A]=N.useState([]),[I,B]=N.useState([]),[z,J]=N.useState(null),[W,q]=N.useState(null),[Y,G]=N.useState(null),[M,V]=N.useState(""),[Z,H]=N.useState(!1),[X,Q]=N.useState(""),[K,ee]=N.useState("date-desc"),[ae,te]=N.useState(null),[se,re]=N.useState(!1),[le,ne]=N.useState(null),[ie,de]=N.useState(!1),[oe,ce]=N.useState(new Set),[me,xe]=N.useState(null),[ge,pe]=N.useState(!1),he=N.useRef(null),{loadSetups:ue,deleteSetup:be,loading:je,error:ye}=$(),{saveSetup:fe}=$(),{user:ve}=k(),Ne=e=>e?e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"";N.useEffect(()=>{w&&we()},[w]),N.useEffect(()=>{_e()},[M,K,X,F]);const we=async()=>{if(!w||!ve)return;const e=await ue(w);A(e),B(e)},_e=()=>{let e=F;M&&(e=F.filter(e=>{var a,t;const s=(null==(a=e.car_number)?void 0:a.toLowerCase())||"",r=(null==(t=e.track_name)?void 0:t.toLowerCase())||"",l=M.toLowerCase();return s.includes(l)||r.includes(l)})),X&&(e=e.filter(e=>e.race_type===X)),e=[...e].sort((e,a)=>{switch(K){case"date-desc":return new Date(a.created_at).getTime()-new Date(e.created_at).getTime();case"date-asc":return new Date(e.created_at).getTime()-new Date(a.created_at).getTime();case"name-asc":return(e.car_number||"").localeCompare(a.car_number||"");case"name-desc":return(a.car_number||"").localeCompare(e.car_number||"");case"lap-asc":return(e.best_lap_time?Number(e.best_lap_time):1/0)-(a.best_lap_time?Number(a.best_lap_time):1/0);case"lap-desc":const t=e.best_lap_time?Number(e.best_lap_time):-1/0;return(a.best_lap_time?Number(a.best_lap_time):-1/0)-t;default:return 0}}),B(e)},ke=e=>{_(`/${w}`,{state:{loadedSetup:e}})},Se=e=>new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>_(`/${w}`),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors","aria-label":"Go back",children:e.jsx(a,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold",children:[Ne(w)," Saved Setups"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"View, load, and manage your saved setups"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(t,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:M,onChange:e=>V(e.target.value),placeholder:"Search by car number or track...",className:"w-full pl-10 pr-4 py-3 rounded-lg bg-gray-100 dark:bg-gray-700"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[oe.size>0&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:async()=>{if(0===oe.size)return xe("Please select at least one setup to email"),void setTimeout(()=>xe(null),3e3);try{const e=F.filter(e=>oe.has(e.id)),{data:a}=await S.from("profiles").select("username, full_name, email").eq("id",null==ve?void 0:ve.id).maybeSingle(),t=(null==a?void 0:a.full_name)||(null==a?void 0:a.username)||"PitBox User",s=`Racing Setups from ${t} - ${Ne(w)}`;let r=`Hi,\n\n${t} is sharing ${e.length} racing setup${e.length>1?"s":""} with you:\n\n`;if(e.forEach((e,a)=>{r+=`\n--- Setup ${a+1} ---\n`,r+=`Car: ${e.car_number||"N/A"}\n`,r+=`Track: ${e.track_name||"N/A"}\n`,e.best_lap_time&&(r+=`Best Lap: ${e.best_lap_time}s\n`),r+=`Date: ${new Date(e.created_at).toLocaleDateString()}\n`,e.setup_data&&(r+="\nSetup Details:\n",Object.entries(e.setup_data).forEach(([e,a])=>{if(a&&"object"==typeof a){const t=e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase());r+=`\n${t}:\n`,Object.entries(a).forEach(([e,a])=>{if(a&&"object"==typeof a&&a.feature){const t=e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase());r+=`  ${t}: ${a.feature}`,a.comment&&(r+=` (${a.comment})`),r+="\n"}})}})),r+="\n"}),r+="\n\nShared from PitBox Racing App\nwww.pitbox.app",C.isNativePlatform()&&R)await R.share({title:s,text:r,dialogTitle:"Email Setups"});else{const e=`mailto:?subject=${encodeURIComponent(s)}&body=${encodeURIComponent(r)}`;window.location.href=e}pe(!0),ce(new Set),setTimeout(()=>pe(!1),3e3)}catch(e){xe("Failed to prepare email. Please try again."),setTimeout(()=>xe(null),5e3)}},className:"px-4 py-2 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-colors flex items-center gap-2 font-semibold shadow-md hover:shadow-lg",title:"Email selected setups",children:[e.jsx(s,{className:"w-5 h-5"}),e.jsxs("span",{children:["Email (",oe.size,")"]})]}),e.jsx("button",{onClick:()=>ce(new Set),className:"px-3 py-2 rounded-lg bg-gray-500 text-white hover:bg-gray-600 transition-colors flex items-center gap-2",title:"Clear selection",children:e.jsx(r,{className:"w-4 h-4"})})]}),e.jsxs("button",{onClick:()=>H(!Z),className:"px-4 py-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 flex items-center gap-2",children:[e.jsx(l,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Filter & Sort"}),e.jsx(n,{className:"w-4 h-4"})]}),e.jsx("input",{ref:he,type:"file",accept:".json",onChange:async e=>{var a,t,s,r;const l=null==(a=e.target.files)?void 0:a[0];if(l){te(null),re(!1);try{if(!l.name.endsWith(".json"))throw new Error("Please select a valid JSON setup file");const e=await l.text(),a=JSON.parse(e);if(!a.car_type||!a.setup_data)throw new Error("Invalid setup file format");if(a.version&&"1.0.0"!==a.version)throw new Error("This setup was exported from an incompatible version of PitBox");if(a.car_type!==w)throw new Error(`This setup is for ${a.car_type}, but you're viewing ${w} setups`);const n=(null==(t=a.exported_by)?void 0:t.name)||"Unknown User";if(!window.confirm(`Import setup from ${n}?\n\nSetup: ${a.setup_name||"Untitled"}\nTrack: ${a.track_name||"N/A"}\nDate: ${a.created_at?new Date(a.created_at).toLocaleDateString():"N/A"}\n${a.best_lap_time?`Best Lap: ${Number(a.best_lap_time).toFixed(3)}s\n`:""}\nThis will be added to your setup library.`))return;const i=await fe(a.car_type,a.setup_data,a.track_conditions||{},a.best_lap_time||null);if(!i)throw new Error("Failed to save imported setup");{const{error:e}=await S.from("setups").update({shared_by_name:(null==(s=a.exported_by)?void 0:s.name)||"Unknown User",shared_by_email:(null==(r=a.exported_by)?void 0:r.email)||null,is_imported:!0,share_notes:a.share_notes||null}).eq("id",i.id);await we(),re(!0),setTimeout(()=>re(!1),3e3)}}catch(n){n instanceof SyntaxError?te("Invalid JSON file format"):n instanceof Error?te(n.message):te("Failed to import setup")}finally{e.target&&(e.target.value="")}}},className:"hidden"}),e.jsxs("button",{onClick:()=>{var e;return null==(e=he.current)?void 0:e.click()},className:"px-5 py-2.5 rounded-lg bg-green-500 text-white hover:bg-green-600 transition-colors flex items-center gap-2 font-semibold shadow-md hover:shadow-lg",title:"Import a setup file from your team",children:[e.jsx(i,{className:"w-5 h-5"}),e.jsx("span",{children:"Import Setup"})]}),e.jsxs("button",{onClick:()=>_(`/${w}`),className:"px-4 py-2 rounded-lg bg-brand-gold text-white hover:bg-brand-gold-dark transition-colors flex items-center gap-2",children:[e.jsx(d,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Back to Setup"}),e.jsx("span",{className:"sm:hidden",children:"Back"})]})]})]}),Z&&e.jsx("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 animate-fadeIn",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[e.jsx(l,{className:"w-4 h-4"}),"Filter by Race Type"]}),e.jsxs("select",{value:X,onChange:e=>Q(e.target.value),className:"w-full px-4 py-2 rounded-lg bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-brand-gold",children:[e.jsx("option",{value:"",children:"All Race Types"}),T.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Sort By"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>ee("date-desc"),className:"px-3 py-2 rounded-lg flex items-center gap-2 text-sm "+("date-desc"===K?"bg-brand-gold text-white":"bg-white dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600"),children:[e.jsx(o,{className:"w-4 h-4"}),"Newest First"]}),e.jsxs("button",{onClick:()=>ee("date-asc"),className:"px-3 py-2 rounded-lg flex items-center gap-2 text-sm "+("date-asc"===K?"bg-brand-gold text-white":"bg-white dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600"),children:[e.jsx(c,{className:"w-4 h-4"}),"Oldest First"]}),e.jsxs("button",{onClick:()=>ee("name-asc"),className:"px-3 py-2 rounded-lg flex items-center gap-2 text-sm "+("name-asc"===K?"bg-brand-gold text-white":"bg-white dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600"),children:[e.jsx(c,{className:"w-4 h-4"}),"Car # (A-Z)"]}),e.jsxs("button",{onClick:()=>ee("name-desc"),className:"px-3 py-2 rounded-lg flex items-center gap-2 text-sm "+("name-desc"===K?"bg-brand-gold text-white":"bg-white dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600"),children:[e.jsx(o,{className:"w-4 h-4"}),"Car # (Z-A)"]}),e.jsxs("button",{onClick:()=>ee("lap-asc"),className:"px-3 py-2 rounded-lg flex items-center gap-2 text-sm "+("lap-asc"===K?"bg-brand-gold text-white":"bg-white dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600"),children:[e.jsx(c,{className:"w-4 h-4"}),"Fastest Lap"]}),e.jsxs("button",{onClick:()=>ee("lap-desc"),className:"px-3 py-2 rounded-lg flex items-center gap-2 text-sm "+("lap-desc"===K?"bg-brand-gold text-white":"bg-white dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600"),children:[e.jsx(o,{className:"w-4 h-4"}),"Slowest Lap"]})]})]})]})})]}),(ae||se||le||ie||me||ge)&&e.jsxs("div",{className:"glass-panel p-4 space-y-3",children:[ae&&e.jsxs("div",{className:"p-4 rounded-lg bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 flex items-center gap-3 border border-red-300 dark:border-red-700",children:[e.jsx(m,{className:"w-6 h-6 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold",children:"Import Failed"}),e.jsx("div",{className:"text-sm",children:ae})]}),e.jsx("button",{onClick:()=>te(null),className:"p-1.5 hover:bg-red-200 dark:hover:bg-red-800 rounded-lg transition-colors","aria-label":"Dismiss",children:e.jsx(r,{className:"w-5 h-5"})})]}),se&&e.jsxs("div",{className:"p-4 rounded-lg bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 flex items-center gap-3 border border-green-300 dark:border-green-700",children:[e.jsx(x,{className:"w-6 h-6 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Setup Imported!"}),e.jsx("div",{className:"text-sm",children:"Setup has been added to your library"})]})]}),le&&e.jsxs("div",{className:"p-4 rounded-lg bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 flex items-center gap-3 border border-red-300 dark:border-red-700",children:[e.jsx(m,{className:"w-6 h-6 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold",children:"Export Failed"}),e.jsx("div",{className:"text-sm",children:le})]}),e.jsx("button",{onClick:()=>ne(null),className:"p-1.5 hover:bg-red-200 dark:hover:bg-red-800 rounded-lg transition-colors","aria-label":"Dismiss",children:e.jsx(r,{className:"w-5 h-5"})})]}),ie&&e.jsxs("div",{className:"p-4 rounded-lg bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 flex items-center gap-3 border border-green-300 dark:border-green-700",children:[e.jsx(x,{className:"w-6 h-6 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Setup Exported!"}),e.jsx("div",{className:"text-sm",children:"Share the file with your team via text, email, or AirDrop"})]})]}),me&&e.jsxs("div",{className:"p-4 rounded-lg bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 flex items-center gap-3 border border-red-300 dark:border-red-700",children:[e.jsx(m,{className:"w-6 h-6 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold",children:"Email Failed"}),e.jsx("div",{className:"text-sm",children:me})]}),e.jsx("button",{onClick:()=>xe(null),className:"p-1.5 hover:bg-red-200 dark:hover:bg-red-800 rounded-lg transition-colors","aria-label":"Dismiss",children:e.jsx(r,{className:"w-5 h-5"})})]}),ge&&e.jsxs("div",{className:"p-4 rounded-lg bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 flex items-center gap-3 border border-green-300 dark:border-green-700",children:[e.jsx(x,{className:"w-6 h-6 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Email Prepared!"}),e.jsx("div",{className:"text-sm",children:"Your email client should open with the setup details"})]})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[ye&&e.jsxs("div",{className:"mb-6 p-4 rounded-lg bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 flex items-center gap-2",children:[e.jsx(m,{className:"w-5 h-5 flex-shrink-0"}),ye]}),je?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(g,{className:"w-8 h-8 animate-spin text-brand-gold mr-3"}),e.jsx("span",{children:"Loading setups..."})]}):0===I.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(d,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"No Setups Found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:M?"No setups match your search criteria.":"You haven't saved any setups for this vehicle yet."}),e.jsxs("button",{onClick:()=>_(`/${w}`),className:"btn-primary inline-flex items-center gap-2",children:[e.jsx(a,{className:"w-5 h-5"}),"Back to Setup Page"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between pb-3 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("button",{onClick:()=>{oe.size===I.length?ce(new Set):ce(new Set(I.map(e=>e.id)))},className:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:[oe.size===I.length?e.jsx(p,{className:"w-5 h-5 text-brand-gold"}):e.jsx(h,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:oe.size===I.length?"Deselect All":"Select All"})]}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[I.length," setup",1!==I.length?"s":""]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:I.map(a=>{var t,s,r,n;return e.jsxs("div",{className:"glass-panel p-5 hover:shadow-lg transition-all rounded-xl relative group border-2 bg-white dark:bg-gray-800 "+(oe.has(a.id)?"border-brand-gold ring-2 ring-brand-gold/30":"border-gray-200 dark:border-gray-700"),children:[e.jsx("button",{onClick:e=>{var t;e.stopPropagation(),t=a.id,ce(e=>{const a=new Set(e);return a.has(t)?a.delete(t):a.add(t),a})},className:"absolute top-3 left-3 z-10 p-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Select setup",children:oe.has(a.id)?e.jsx(p,{className:"w-5 h-5 text-brand-gold"}):e.jsx(h,{className:"w-5 h-5 text-gray-400"})}),e.jsxs("div",{className:"cursor-pointer pl-8",onClick:()=>ke(a),children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:"font-bold text-xl",children:a.car_number?`Car #${a.car_number}`:"Untitled Setup"})}),a.track_name&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400 mb-2",children:[e.jsx(u,{className:"w-4 h-4 mr-1 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:a.track_name})]}),a.best_lap_time&&e.jsxs("div",{className:"flex items-center text-sm font-semibold text-brand-gold mb-2",children:[e.jsx(b,{className:"w-4 h-4 mr-1 flex-shrink-0"}),e.jsxs("span",{children:["Best Lap: ",Number(a.best_lap_time).toFixed(3),"s"]})]}),a.race_type&&e.jsxs("div",{className:"flex items-center text-sm text-blue-600 dark:text-blue-400 mb-2",children:[e.jsx(l,{className:"w-4 h-4 mr-1 flex-shrink-0"}),e.jsx("span",{className:"font-medium",children:(null==(t=T.find(e=>e.value===a.race_type))?void 0:t.label)||a.race_type})]}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400 mb-4",children:[e.jsx(j,{className:"w-3 h-3 mr-1 flex-shrink-0"}),e.jsx("span",{children:(n=a.created_at,new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))}),e.jsx("span",{className:"mx-1",children:"•"}),e.jsx(b,{className:"w-3 h-3 mr-1 flex-shrink-0"}),e.jsx("span",{children:Se(a.created_at)})]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2",children:(null==(s=a.setup_data.notes_general)?void 0:s.feature)||(null==(r=a.setup_data.notes_track)?void 0:r.feature)||a.notes||"No additional notes"})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-between",children:[e.jsx("button",{onClick:()=>ke(a),className:"px-3 py-1.5 bg-brand-gold text-white rounded-lg hover:bg-brand-gold-dark transition-colors text-sm",children:"Load Setup"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),(async e=>{try{const{data:a}=await S.from("profiles").select("username, full_name, email").eq("id",null==ve?void 0:ve.id).maybeSingle(),t=Object.keys(e.setup_data||{}).reduce((a,t)=>{const s=e.setup_data[t];if(!s||"object"!=typeof s)return a[t]=s,a;const r=Object.keys(s).reduce((e,a)=>(a.includes("shock_number")||a.includes("shock_serial")||a.includes("shock_id")||a.includes("dyno")||a.toLowerCase().includes("weight")||(e[a]=s[a]),e),{});return a[t]=r,a},{}),s={version:"1.0.0",exported_at:(new Date).toISOString(),exported_by:{name:(null==a?void 0:a.full_name)||(null==a?void 0:a.username)||"PitBox User",email:(null==a?void 0:a.email)||(null==ve?void 0:ve.email)||""},setup_name:`${e.car_number?`Car #${e.car_number}`:"Setup"} - ${e.track_name||"Track"}`,car_type:e.car_type,car_number:e.car_number,track_name:e.track_name,best_lap_time:e.best_lap_time,setup_data:t,track_conditions:e.track_conditions,created_at:e.created_at,share_notes:"Shared from PitBox Racing App"},r=JSON.stringify(s,null,2),l=e.car_type.replace(/-/g,"_"),n=`pitbox_${l}${e.car_number?`_${e.car_number}`:""}${e.track_name?`_${e.track_name.replace(/[^a-zA-Z0-9]/g,"_")}`:""}_${new Date(e.created_at).toISOString().split("T")[0]}.json`;if(C.isNativePlatform()){const e=await P.writeFile({path:n,data:r,directory:L.Cache,encoding:U.UTF8});await R.share({title:s.setup_name,text:`Racing setup from ${s.exported_by.name}`,url:e.uri,dialogTitle:"Share Setup"})}else{const e=new Blob([r],{type:"application/json"}),a=URL.createObjectURL(e),t=document.createElement("a");t.href=a,t.download=n,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(a)}de(!0),setTimeout(()=>de(!1),3e3)}catch(a){ne("Failed to export setup. Please try again."),setTimeout(()=>ne(null),5e3)}})(a)},className:"px-3 py-2 bg-green-500 dark:bg-green-600 text-white hover:bg-green-600 dark:hover:bg-green-700 rounded-lg transition-colors flex items-center gap-2 font-medium shadow-sm",title:"Export setup to share with team",children:ie?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Exported!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Export"})]})}),e.jsx("button",{onClick:e=>{e.stopPropagation(),(async e=>{q(e);try{const a=`${null==w?void 0:w.toUpperCase()} Setup - Car #${e.car_number||"Untitled"} - ${e.track_name||"No Track"} - Created: ${new Date(e.created_at).toLocaleDateString()}`;await navigator.clipboard.writeText(a),G(e.id),setTimeout(()=>G(null),2e3),setTimeout(()=>{window.print(),q(null)},300)}catch(a){}})(a)},className:"p-2 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-blue-100 hover:text-blue-600 dark:hover:bg-blue-900/30 dark:hover:text-blue-400 rounded-lg transition-colors",title:"Print setup",children:e.jsx(f,{className:"w-5 h-5"})}),z!==a.id?e.jsx("button",{onClick:e=>{e.stopPropagation(),J(a.id)},className:"p-1.5 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-red-100 hover:text-red-600 dark:hover:bg-red-900/30 dark:hover:text-red-400 rounded-lg transition-colors",title:"Delete setup",children:e.jsx(v,{className:"w-5 h-5"})}):e.jsxs("div",{className:"absolute right-4 top-16 p-3 bg-white dark:bg-gray-800 rounded-lg shadow-lg z-10 border border-red-200 dark:border-red-800 w-[200px]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(m,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"font-medium text-red-700 dark:text-red-300",children:"Delete this setup?"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),(async e=>{await be(e)&&(A(a=>a.filter(a=>a.id!==e)),B(a=>a.filter(a=>a.id!==e)),J(null))})(a.id)},className:"flex-1 bg-red-500 hover:bg-red-600 text-white py-1 px-3 rounded-lg transition-colors",children:"Delete"}),e.jsx("button",{onClick:e=>{e.stopPropagation(),J(null)},className:"flex-1 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 py-1 px-3 rounded-lg transition-colors",children:"Cancel"})]})]})]})]})]},a.id)})})]})]}),W&&e.jsx("div",{className:"print-only",children:e.jsx(O,{setup:W,carType:w||""})}),e.jsxs("div",{className:"glass-panel p-6 bg-gradient-to-br from-blue-500/5 to-purple-500/5",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Setup Sharing Instructions"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5 text-green-500"}),"Exporting Setups"]}),e.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:[e.jsx("li",{children:"• Click the download button on any setup to export it as a JSON file"}),e.jsx("li",{children:"• The file will be saved to your device's Downloads folder"}),e.jsx("li",{children:"• Share the file with other users via email, messaging, or cloud storage"}),e.jsx("li",{children:"• Files are automatically synced to iCloud Drive (iOS) or Google Drive (Android)"})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[e.jsx(i,{className:"w-5 h-5 text-blue-500"}),"Importing Setups"]}),e.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:[e.jsx("li",{children:'• Click "Import Setup" to select a JSON setup file'}),e.jsx("li",{children:"• The setup will be validated and added to your collection"}),e.jsx("li",{children:"• Only setups matching the current vehicle type can be imported"}),e.jsx("li",{children:"• Imported setups become part of your personal setup library"})]})]})]})]})]})}},Symbol.toStringTag,{value:"Module"}));export{U as E,I as S};
