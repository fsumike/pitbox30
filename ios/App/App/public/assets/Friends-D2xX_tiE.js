import{j as e,ac as s,ae as a,L as r,B as t,U as l,a4 as n,at as d}from"./ui-a5pT2S0L.js";import{r as o}from"./react-CLW9qjVv.js";import{u as i,c}from"./index-DMaHBciH.js";import{u as g}from"./useFriends-tNApKr2A.js";import{u as m}from"./router-CsjlwGXH.js";import"./supabase-Dols_XF-.js";function x(){const x=m();i();const{startChat:u}=c(),{getFriends:h,getSuggestedFriends:j,sendFriendRequest:p,getPendingRequests:f,respondToFriendRequest:b,loading:v,error:N}=g(),[y,w]=o.useState([]),[k,C]=o.useState([]),[_,q]=o.useState([]),[S,F]=o.useState(""),[L,R]=o.useState("friends");o.useEffect((()=>{P()}),[]);const P=async()=>{const[e,s,a]=await Promise.all([h(),j(5),f()]);w(e),C(s),q(a)},B=async(e,s)=>{await b(e,s)&&P()},O=y.filter((e=>{var s;return e.username.toLowerCase().includes(S.toLowerCase())||(null==(s=e.full_name)?void 0:s.toLowerCase().includes(S.toLowerCase()))}));return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>x(-1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors","aria-label":"Go back",children:e.jsx(s,{className:"w-6 h-6"})}),e.jsx("img",{src:"/android-icon-192-192.png",alt:"PIT-BOX.COM",className:"w-16 h-16 sm:w-20 sm:h-20 object-contain flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Friends & Connections"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Connect with fellow racers and build your network"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(a,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:S,onChange:e=>F(e.target.value),placeholder:"Search friends...",className:"w-full pl-10 pr-4 py-2 rounded-lg bg-gray-100 dark:bg-gray-700"})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>R("friends"),className:"flex-1 px-4 py-2 rounded-lg transition-colors "+("friends"===L?"bg-brand-gold text-white":"hover:bg-gray-100 dark:hover:bg-gray-700"),children:["Friends (",y.length,")"]}),e.jsxs("button",{onClick:()=>R("requests"),className:"flex-1 px-4 py-2 rounded-lg transition-colors "+("requests"===L?"bg-brand-gold text-white":"hover:bg-gray-100 dark:hover:bg-gray-700"),children:["Requests (",_.length,")"]}),e.jsx("button",{onClick:()=>R("suggested"),className:"flex-1 px-4 py-2 rounded-lg transition-colors "+("suggested"===L?"bg-brand-gold text-white":"hover:bg-gray-100 dark:hover:bg-gray-700"),children:"Suggested"})]})]}),e.jsx("div",{className:"glass-panel p-6",children:v?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(r,{className:"w-8 h-8 animate-spin text-brand-gold"})}):N?e.jsxs("div",{className:"flex items-center gap-2 text-red-500 p-4",children:[e.jsx(t,{className:"w-5 h-5"}),e.jsx("p",{children:N})]}):e.jsxs("div",{className:"space-y-4",children:["friends"===L&&(O.length>0?O.map((s=>e.jsxs("div",{className:"flex items-center gap-3 p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 rounded-lg transition-colors",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-brand-gold/10 flex items-center justify-center overflow-hidden",children:s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:s.username,className:"w-full h-full object-cover"}):e.jsx(l,{className:"w-6 h-6 text-brand-gold"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:s.full_name||s.username}),s.location&&e.jsx("p",{className:"text-sm text-gray-500 truncate",children:s.location})]}),e.jsx("button",{onClick:()=>u(s.id),className:"p-2 text-brand-gold hover:bg-brand-gold/10 rounded-full transition-colors",children:e.jsx(n,{className:"w-5 h-5"})})]},s.id))):e.jsx("p",{className:"text-center text-gray-500 py-4",children:S?"No friends match your search":"No friends yet"})),"requests"===L&&(_.length>0?_.map((s=>e.jsxs("div",{className:"flex items-center gap-3 p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 rounded-lg transition-colors",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-brand-gold/10 flex items-center justify-center overflow-hidden",children:s.sender.avatar_url?e.jsx("img",{src:s.sender.avatar_url,alt:s.sender.username,className:"w-full h-full object-cover"}):e.jsx(l,{className:"w-6 h-6 text-brand-gold"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:s.sender.full_name||s.sender.username}),s.sender.location&&e.jsx("p",{className:"text-sm text-gray-500 truncate",children:s.sender.location})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>B(s.id,!0),className:"px-4 py-2 bg-brand-gold text-white rounded-lg hover:bg-brand-gold-dark transition-colors",children:"Accept"}),e.jsx("button",{onClick:()=>B(s.id,!1),className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Decline"})]})]},s.id))):e.jsx("p",{className:"text-center text-gray-500 py-4",children:"No pending friend requests"})),"suggested"===L&&(k.length>0?k.map((s=>e.jsxs("div",{className:"flex items-center gap-3 p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 rounded-lg transition-colors",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-brand-gold/10 flex items-center justify-center overflow-hidden",children:s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:s.username,className:"w-full h-full object-cover"}):e.jsx(l,{className:"w-6 h-6 text-brand-gold"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:s.full_name||s.username}),s.location&&e.jsx("p",{className:"text-sm text-gray-500 truncate",children:s.location})]}),e.jsx("button",{onClick:()=>(async e=>{await p(e)&&P()})(s.id),className:"p-2 text-brand-gold hover:bg-brand-gold/10 rounded-full transition-colors",children:e.jsx(d,{className:"w-5 h-5"})})]},s.id))):e.jsx("p",{className:"text-center text-gray-500 py-4",children:"No suggested friends at the moment"}))]})})]})}export{x as default};
