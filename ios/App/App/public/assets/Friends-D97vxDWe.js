import{j as e,ac as s,ae as a,L as r,B as t,U as l,a4 as n,at as d}from"./ui-v2ReSvUE.js";import{r as i}from"./react-YWE4JMTy.js";import{u as o,c}from"./index-Cgc97SP_.js";import{u as g}from"./useFriends-Dq8pWR3D.js";import{u as m}from"./router-BNBI7_bc.js";import"./supabase-Du4GZSDg.js";function x(){const x=m(),{user:u}=o(),{startChat:h}=c(),{getFriends:j,getSuggestedFriends:p,sendFriendRequest:f,getPendingRequests:b,respondToFriendRequest:v,loading:N,error:y}=g(),[w,k]=i.useState([]),[C,_]=i.useState([]),[q,S]=i.useState([]),[F,L]=i.useState(""),[R,P]=i.useState("friends");i.useEffect(()=>{B()},[]);const B=async()=>{const[e,s,a]=await Promise.all([j(),p(5),b()]);k(e),_(s),S(a)},O=async(e,s)=>{await v(e,s)&&B()},T=w.filter(e=>{var s;return e.username.toLowerCase().includes(F.toLowerCase())||(null==(s=e.full_name)?void 0:s.toLowerCase().includes(F.toLowerCase()))});return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>x(-1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors","aria-label":"Go back",children:e.jsx(s,{className:"w-6 h-6"})}),e.jsx("img",{src:"/android-icon-192-192.png",alt:"PIT-BOX.COM",className:"w-16 h-16 sm:w-20 sm:h-20 object-contain flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Friends & Connections"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Connect with fellow racers and build your network"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(a,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:F,onChange:e=>L(e.target.value),placeholder:"Search friends...",className:"w-full pl-10 pr-4 py-2 rounded-lg bg-gray-100 dark:bg-gray-700"})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>P("friends"),className:"flex-1 px-4 py-2 rounded-lg transition-colors "+("friends"===R?"bg-brand-gold text-white":"hover:bg-gray-100 dark:hover:bg-gray-700"),children:["Friends (",w.length,")"]}),e.jsxs("button",{onClick:()=>P("requests"),className:"flex-1 px-4 py-2 rounded-lg transition-colors "+("requests"===R?"bg-brand-gold text-white":"hover:bg-gray-100 dark:hover:bg-gray-700"),children:["Requests (",q.length,")"]}),e.jsx("button",{onClick:()=>P("suggested"),className:"flex-1 px-4 py-2 rounded-lg transition-colors "+("suggested"===R?"bg-brand-gold text-white":"hover:bg-gray-100 dark:hover:bg-gray-700"),children:"Suggested"})]})]}),e.jsx("div",{className:"glass-panel p-6",children:N?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(r,{className:"w-8 h-8 animate-spin text-brand-gold"})}):y?e.jsxs("div",{className:"flex items-center gap-2 text-red-500 p-4",children:[e.jsx(t,{className:"w-5 h-5"}),e.jsx("p",{children:y})]}):e.jsxs("div",{className:"space-y-4",children:["friends"===R&&(T.length>0?T.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 rounded-lg transition-colors",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-brand-gold/10 flex items-center justify-center overflow-hidden",children:s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:s.username,className:"w-full h-full object-cover"}):e.jsx(l,{className:"w-6 h-6 text-brand-gold"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:s.full_name||s.username}),s.location&&e.jsx("p",{className:"text-sm text-gray-500 truncate",children:s.location})]}),e.jsx("button",{onClick:()=>h(s.id),className:"p-2 text-brand-gold hover:bg-brand-gold/10 rounded-full transition-colors",children:e.jsx(n,{className:"w-5 h-5"})})]},s.id)):e.jsx("p",{className:"text-center text-gray-500 py-4",children:F?"No friends match your search":"No friends yet"})),"requests"===R&&(q.length>0?q.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 rounded-lg transition-colors",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-brand-gold/10 flex items-center justify-center overflow-hidden",children:s.sender.avatar_url?e.jsx("img",{src:s.sender.avatar_url,alt:s.sender.username,className:"w-full h-full object-cover"}):e.jsx(l,{className:"w-6 h-6 text-brand-gold"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:s.sender.full_name||s.sender.username}),s.sender.location&&e.jsx("p",{className:"text-sm text-gray-500 truncate",children:s.sender.location})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>O(s.id,!0),className:"px-4 py-2 bg-brand-gold text-white rounded-lg hover:bg-brand-gold-dark transition-colors",children:"Accept"}),e.jsx("button",{onClick:()=>O(s.id,!1),className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Decline"})]})]},s.id)):e.jsx("p",{className:"text-center text-gray-500 py-4",children:"No pending friend requests"})),"suggested"===R&&(C.length>0?C.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 rounded-lg transition-colors",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-brand-gold/10 flex items-center justify-center overflow-hidden",children:s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:s.username,className:"w-full h-full object-cover"}):e.jsx(l,{className:"w-6 h-6 text-brand-gold"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:s.full_name||s.username}),s.location&&e.jsx("p",{className:"text-sm text-gray-500 truncate",children:s.location})]}),e.jsx("button",{onClick:()=>(async e=>{await f(e)&&B()})(s.id),className:"p-2 text-brand-gold hover:bg-brand-gold/10 rounded-full transition-colors",children:e.jsx(d,{className:"w-5 h-5"})})]},s.id)):e.jsx("p",{className:"text-center text-gray-500 py-4",children:"No suggested friends at the moment"}))]})})]})}export{x as default};
